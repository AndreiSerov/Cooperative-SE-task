## План выполнения первого набора требований

0. **Подготовительные шаги**
    1. Включить toggl
    2. Прочитать требования
    3. Создать репозиторий
    4. Создать пустой проект в Idea

1. **Описать тестовые данные**
    1. Описать пользователей  
     
     № | login | pass 
     --- | --- | ---  
     U1 | vasya | 123  
     U2 | admin | admin  
     U3 | q | ?!#  
     U4 | abcdefghij | pass
    
    2. Описать ресурсы  
     
     № | res | role | user
     --- | --- | --- | ---
     R1 | A | READ | vasya
     R2 | A.B.C | WRITE | vasya
     R3 | A.B | EXECUTE | admin
     R4 | A | READ | admin
     R5 | A.B | WRITE | admin
     R6 | A.B.C | READ | admin
     R7 | B | EXECUTE | q
 
2. **Создать скрипты**
    1. Записать тесты в bat/sh файл
     
     № | Входные данные | Ожидаемый результат
      --- | --- | ---
     T1.1 | app.jar | 1 + справка
     T1.2 | app.jar -h | 1 + справка
     T1.3 | app.jar -q | 0 + справка
     Т1.4 | app.jar 12345 | 0 + справка
     T1.5 | app.jar -res A.B 12345 | 0 + справка
     T2.1 | app.jar -login vasya -pass 123 | 0
     T2.2 | app.jar -login VASYA -pass 123 | 2
     T2.3 | app.jar -login asd -pass 123 | 3
     T2.4 | app.jar -login admin -pass 123 | 4
     T3.1 | app.jar -login vasya -pass 123 -res A -role READ | 0
     T3.2 | app.jar -login vasya -pass 123 -res A -role DELETE | 5
     T3.3 | app.jar -login vasya -pass 123 -res A -role WRITE | 6
     T3.4 | app.jar -login vasya -pass 123 -res A.B -role READ | 0
     T3.5 | app.jar -login vasya -pass 0000 -res A.B -role DELETE | 4
     T3.6 | app.jar -login admin -pass admin -res A -role EXECUTE | 6
     T3.7 | app.jar -login admin -pass admin -res A.A -role WRITE | 6
     T4.1 | app.jar -login vasya -pass 123 -res A -role READ -ds 2020-03-10 -de 2020-03-11 -vol 100 | 0
     T4.2 | app.jar -login vasya -pass 123 -res A -role READ -ds 2020.03.10 -de 2020.03.11 -vol 100 | 7
     T4.3 | app.jar -login vasya -pass 123 -res A -role READ -ds 2020-03-10 -de 2020-03-11 -vol aaaa | 7
     T4.4 | app.jar -login vasya -pass 123 -res A -role EXECUTE -ds 01.02.3012 -de 01.02.2030 -vol aaa | 6
     T4.5 | app.jar -login vasya -pass 123 -res A -role READ -ds 2020-03-11 -de 2020-03-10 -vol 100 | 7
     
     2. Создать скрипт компиляции (**R1.12**)
     3. Создать скрипты запуска (**R1.12**)
 
3. **Простейшие сценарии**
     1. Добавить проверку наличия аргументов в `main` (**R1.8**)
     2. Создать метод (верхнего уровня) вывода справки
     3. Проверяем, надо ли выводить справку 
        + Если пусто, возвращаем 1
        + Если `args[0]=="-h"`, возвращаем 1
        + Если неизвестные аргументы, возвращаем 0
        + Если неправильное число аргументов, возвращаем 0
 
4. **Аутентификация**
     0. Создать класс `Authentication`
     1. Создать метод надо ли аутентифицировать в классе `Authentication`
        + `args[0]=="-login" && args[2]=="-pass"` (**R1.1**)
     2. Создать метод в классе `Authentication` проверки правильности формата логина (**R1.1**)
        + `[a-z]{1,10}`
     3. Создать метод в классе `Authentication` проверки существования логина
         + `login==vasya`
     4. Создать метод в классе `Authentication` проверки пароля
         + `pass==123`
     5. Создать `data class User`
         + `login`
         + `pass`
     6. Создать коллекцию пользователей с тестовыми данными
     7. Исправляем методы 4.3 и 4.4 на работу с коллекцией пользователей
     8. Создать класс `ArgHandler` 
        + `h`
        + `login`
        + `pass`
        + конструктор (`args:Array<String>` )
        + метод `нужна ли справка` (переносим сюда метод 3.iii)
        + метод `есть ли аргументы` (переносим 3.i)
        + метод `нужна ли аутентификация`
     9. Переписать код, чтобы использовался `ArgHandler`
     10. Дополнить справку
 
 5. **Авторизация**
     1. В `ArgHandler` создать `метод нужна ли авторизация` (**R1.11**)
        1. Проверяем наличие обязательных параметров (ресурса и роли)
        2. Если не нужна авторизация, то заканчиваем программу с кодом 0  
        Иначе запускаем авторизацию
     2. Создать `data class Resource`
         + `res`
         + `role`
         + `user`
     3. Создать коллекцию ресурсов с тестовыми данными 
     4. Создать список допустимых ролей
     5. Создать класс `Authorization` 
     6. Создать в классе `Authorization` метод проверки существования роли(**R1.5**)
     7. Добавить поля `res` и `role` в `ArgHandler`
     8. Добавить метод проверки формата ресурса в класс `Authorization` (**R1.3**)
         + Если неверный формат ресурса, заканчиваем выполнение программы с кодом 6  
          Иначе продолжаем выполнение программы
     9. Добавляем метод поиска ресурса по имени в класс `Authorization`(**R1.3**)
     10. Создать метод проверки доступа в классе `Authorization` (**R1.3**)
         + `user==vasya res==A role==READ`
     11. Переделать метод 6.x на работу с коллекцией
     12. Добавляем метод проверки вложенности ресурса (**R1.6, R1.4**) 
         + Используем `substring(0,res.length)`:
         если ресурс из таблицы является началом требуемого  
         ресурса, предоставить доступ)
     13. Создать метод авторизации в классе `Authorization` в котором будет  
         вызов метода 6.ix, а из него 6.x
     14. В метод поиска ресурса добавить флаг `доступ получен` (**R1.6**)
     15. Дополняем справку
 
6. **Аккаунтинг**
     1. Добавляем поля `ds`, `de`, `vol` в `ArgHandler` 
     2. Создаем метод нужен ли аккаунтинг в классе `ArgHandler` (**R1.11**)
     3. Создать `data class Session` c полями:
        + `user`
        + `role`
        + `res`
        + `ds`
        + `de`
        + `vol`
     4. Создать класс `Accounting` 
     4. Создать метод обработки параметров `-ds -de -vol` в классе `Accounting`(**R1.7**)
     5. Создать метод проверки формата `ds` и `de` в классе `Accounting`
        + Если формат неверен, то возвращаем код 7 (**R1.9**)  
          Иначе продолжаем выполнение программы
     6. Записываем данные в экземпляр класса `Session`
     7. Сохраняем этот объект в коллекцию
     8. Дополняем справку

7. **Безопасность**
    1. Добавляем в класс `User` поле соль
    2. В тестовых данных пароль заменить на `хэш(пароль+соль)`
    2. Изменить метод проверки пароля, добавив вычисление хэша перед сравнением
        
8. **Обработка параметров в любом порядке**
     1. Подключаем библиотеку kotlinx.cli для обработки параметров (**R1.10**)
        параметров командной строки в любом порядке
     2. Измененить методов `ArgHandler`, используя kotlinx.cli